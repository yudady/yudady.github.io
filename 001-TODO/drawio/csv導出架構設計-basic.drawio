<mxGraphModel dx="746" dy="684" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="27" value="&lt;div style=&quot;color: rgb(212, 212, 212); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px;&quot;&gt;db : FileDownloadRecordEntity&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;color: rgb(212, 212, 212); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px;&quot;&gt;(  id  报表来源  报表枚举 数据检索条件key值  文件地址 部门Id  管理员id  status   创建时间  完成時間 ) &lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;labelBackgroundColor=default;labelBorderColor=none;" parent="1" vertex="1"><mxGeometry x="79" y="60" width="701" height="60" as="geometry"/></mxCell><mxCell id="28" value="&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px;&quot;&gt;plt-basic &lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="40" y="10" width="160" height="30" as="geometry"/></mxCell><mxCell id="29" value="紀錄數據-返回" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry y="570" width="150" height="50" as="geometry"/></mxCell><mxCell id="31" value="&lt;div style=&quot;color: rgb(212, 212, 212); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px;&quot;&gt;&lt;div&gt;//default: requeue times: 6, requeue delay: 1min&lt;/div&gt;&lt;div&gt;processMessageOrRequeue&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;redis-hash.queryDoneCount 判斷 &amp;gt;= 2 , 如果沒有 requene , 6次失敗更新 FileDownloadRecordEntity.status&lt;/div&gt;&lt;div&gt;csv to gcp&lt;/div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;labelBackgroundColor=default;" parent="1" vertex="1"><mxGeometry x="79" y="130" width="701.5" height="130" as="geometry"/></mxCell><mxCell id="32" value="&lt;span style=&quot;color: rgb(212, 212, 212); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(30, 30, 30); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;mq1.&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="30" y="150" width="60" height="50" as="geometry"/></mxCell><mxCell id="33" value="&lt;span style=&quot;color: rgb(212, 212, 212); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(30, 30, 30); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;mq2.&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="19" y="300" width="60" height="30" as="geometry"/></mxCell><mxCell id="34" value="&lt;div style=&quot;color: rgb(212, 212, 212); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px;&quot;&gt;&lt;div&gt;FanoutExchange : msg(FileDownloadRecordEntity id : 1111 )&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;    Listener&lt;/div&gt;&lt;div&gt;        1. 需要查詢的 plt_account.vs_admin , put data in redis , redis-hash.queryDoneCount hinctby&lt;/div&gt;&lt;div&gt;        2. 需要查詢的 plt_fund.vs_payment  , put data in redis , redis-hash.queryDoneCount hinctby&lt;/div&gt;&lt;div style=&quot;color: rgb(212, 212, 212); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 18px;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;    redis-hash : ttl:5min&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;        key: FileDownloadRecordEntity-1111 (tablename-table.id)&lt;/div&gt;&lt;div&gt;        value: {&lt;/div&gt;&lt;div&gt;            queryDoneCount : 0&lt;/div&gt;&lt;div&gt;            plt_account.vs_admin (Listener) : [......]  &lt;/div&gt;&lt;div&gt;            plt_fund.vs_payment (Listener) : [.....]&lt;/div&gt;&lt;div&gt;        }&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;labelBackgroundColor=default;" parent="1" vertex="1"><mxGeometry x="79" y="274" width="701" height="286" as="geometry"/></mxCell></root></mxGraphModel>